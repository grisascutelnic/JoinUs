<div th:fragment="navbar">
    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="/" th:href="@{/}">
                <span class="navbar-brand-text">
                    JoinUs
                    <small>Community Hub</small>
                </span>
            </a>

            <div class="d-lg-none ms-auto me-3" th:if="${#authorization.expression('isAnonymous()')}">
                <a class="btn custom-btn custom-border-btn js-auth-link" href="#" data-auth-trigger="login">Logare</a>
            </div>

            <div class="d-lg-none ms-auto me-3" th:if="${#authorization.expression('isAuthenticated()')}">
                <form th:action="@{/logout}" method="post" class="m-0">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                    <button type="submit" class="btn custom-btn custom-border-btn">Delogare</button>
                </form>
            </div>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-lg-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/" th:href="@{/}">Home</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="/activities" th:href="@{/activities}">Activitati</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="/profile" th:href="@{/profile}">Profil</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="/calendar" th:href="@{/calendar}">Calendar</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="/chat" th:href="@{/chat}">Chat</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="/map" th:href="@{/map}">Harta</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="/forum" th:href="@{/forum}">Forum</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" data-bs-toggle="offcanvas" href="#notificationsPanel" role="button" aria-controls="notificationsPanel">Notificari</a>
                    </li>
                </ul>

                <div class="d-none d-lg-block ms-lg-3" th:if="${#authorization.expression('isAnonymous()')}">
                    <a class="btn custom-btn custom-border-btn js-auth-link" href="#" data-auth-trigger="login">Logare</a>
                </div>

                <div class="d-none d-lg-block ms-lg-3" th:if="${#authorization.expression('isAuthenticated()')}">
                    <form th:action="@{/logout}" method="post" class="m-0">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                        <button type="submit" class="btn custom-btn custom-border-btn">Delogare</button>
                    </form>
                </div>
            </div>
        </div>
    </nav>

    <div class="modal fade auth-modal" id="loginModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content auth-modal-content">
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Inchide"></button>
                    <div class="auth-card auth-card--modal">
                        <h3 class="mb-3">Intra in cont</h3>
                        <p class="auth-subtitle">Foloseste emailul si parola pentru a continua.</p>

                        <div class="alert alert-success" th:if="${param.registered}">
                            Cont creat cu succes. Te poti autentifica.
                        </div>
                        <div class="alert alert-danger" th:if="${param.error}">
                            Email sau parola incorecta.
                        </div>
                        <div class="alert alert-info" th:if="${param.logout}">
                            Ai fost delogat.
                        </div>

                        <form class="custom-form auth-form" th:action="@{/login}" method="post" role="form">
                            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                            <input type="email" name="email" class="form-control" placeholder="Email" required>
                            <input type="password" name="password" class="form-control" placeholder="Parola" required>

                            <div class="d-flex justify-content-between align-items-center auth-links">
                                <label class="form-check-label">
                                    <input class="form-check-input me-2" type="checkbox" name="remember-me" value="true">Tine-ma minte
                                </label>
                                <a href="/forgot-password" th:href="@{/forgot-password}">Ai uitat parola?</a>
                            </div>

                            <button type="submit" class="form-control mt-3">Logare</button>
                        </form>

                        <p class="auth-footer">Nu ai cont? <a href="#" data-auth-trigger="register">Creeaza unul acum</a></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade auth-modal" id="registerModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content auth-modal-content">
                <div class="modal-body">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Inchide"></button>
                    <div class="auth-card auth-card--modal">
                        <h3 class="mb-3">Creeaza cont</h3>
                        <p class="auth-subtitle">Completeaza datele pentru a intra in comunitate.</p>

                        <div class="alert alert-danger" th:if="${param.registerError}">
                            Completeaza corect toate campurile.
                        </div>

                        <form class="custom-form auth-form" th:action="@{/register}" method="post" role="form">
                            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                            <input type="text" name="fullName" class="form-control" placeholder="Nume complet" required>
                            <input type="email" name="email" class="form-control" placeholder="Email" required>
                            <div class="birthdate-field">
                                <label class="form-label">Data nasterii</label>
                                <input type="hidden" name="birthDate" id="birthDateInput">
                                <div class="birthdate-selects">
                                    <select id="birthDaySelect" class="form-control birthdate-select" aria-label="Ziua nasterii"></select>
                                    <select id="birthMonthSelect" class="form-control birthdate-select" aria-label="Luna nasterii"></select>
                                    <select id="birthYearSelect" class="form-control birthdate-select" aria-label="Anul nasterii"></select>
                                </div>
                            </div>
                            <textarea name="bio" class="form-control" placeholder="Descriere scurta" rows="3"></textarea>
                            <input type="password" name="password" class="form-control" placeholder="Parola" minlength="6" required>
                            <input type="password" name="confirmPassword" class="form-control" placeholder="Confirma parola" minlength="6" required>

                            <label class="form-check-label auth-check">
                                <input class="form-check-input me-2" type="checkbox" required>
                                Sunt de acord cu <a href="/terms" th:href="@{/terms}">Termenii si conditiile</a>.
                            </label>

                            <button type="submit" class="form-control mt-3">Creeaza cont</button>
                        </form>

                        <p class="auth-footer">Ai deja cont? <a href="#" data-auth-trigger="login">Logheaza-te</a></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!doctype html>
<html lang="ro" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Profil utilizator JoinUs">
    <title>Profil</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,700;1,400&display=swap" rel="stylesheet">
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/bootstrap-icons.css" rel="stylesheet">
    <link href="/css/styles.css" rel="stylesheet">
</head>
<body class="page-profile page-profile-modern">
<main th:with="displayUser=${profileUser != null ? profileUser : publicUser},
               displayAvatar=${profileAvatarUrl != null ? profileAvatarUrl : publicUserAvatarUrl},
               activitiesCount=${createdActivities != null ? #lists.size(createdActivities) : 0},
               reviewCount=${ratingSummary != null ? ratingSummary.reviewsCount : 0},
               avgRating=${ratingSummary != null ? ratingSummary.averageRating : 0.0},
               isOwnProfileView=${profileUser != null or (isOwnPublicProfile != null and isOwnPublicProfile)}">
    <div class="landing-theme profile-theme">
        <header th:replace="~{fragments/navbar :: navbar}"></header>

        <div class="offcanvas offcanvas-end" data-bs-scroll="true" tabindex="-1" id="notificationsPanel" aria-labelledby="notificationsPanelLabel">
            <div class="offcanvas-header">
                <h5 class="offcanvas-title text-white" id="notificationsPanelLabel">Notificari</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
            <div class="offcanvas-body d-flex flex-column">
                <div class="notification-item">
                    <strong class="text-white">Profil</strong>
                    <p class="mb-1">Vizualizezi profilul utilizatorului.</p>
                    <small>Acum</small>
                </div>
                <div class="mt-auto">
                    <a href="#" class="btn custom-btn custom-border-btn w-100" data-bs-dismiss="offcanvas">Inchide</a>
                </div>
            </div>
        </div>

        <section class="profile-hero-cover" id="section_profile_hero">
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 col-12 mx-auto text-center hero-content">
                        <h2 class="text-white">Profil JoinUs</h2>
                        <h1 class="text-white mb-0" th:text="${displayUser.fullName}">Nume utilizator</h1>
                    </div>
                </div>
            </div>

            <svg class="hero-wave hero-wave-desktop" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
                <path fill="var(--section-bg-color)" fill-opacity="1" d="M0,224 C240,160 480,288 720,224 C960,160 1200,288 1440,224 L1440,320 L0,320 Z"></path>
            </svg>
            <svg class="hero-wave hero-wave-mobile" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320" preserveAspectRatio="none">
                <path fill="var(--section-bg-color)" fill-opacity="1" d="M0,224 C240,160 480,288 720,224 C960,160 1200,288 1440,224 L1440,320 L0,320 Z"></path>
                <path fill="var(--section-bg-color)" fill-opacity="0.7" transform="translate(0,12)" d="M0,224 C240,160 480,288 720,224 C960,160 1200,288 1440,224 L1440,320 L0,320 Z"></path>
                <path fill="var(--section-bg-color)" fill-opacity="0.4" transform="translate(0,24)" d="M0,224 C240,160 480,288 720,224 C960,160 1200,288 1440,224 L1440,320 L0,320 Z"></path>
            </svg>
        </section>
    </div>

    <div class="profile-container">
        <div class="profile-header">
            <div class="avatar-container">
                <img th:src="${displayAvatar != null ? displayAvatar : 'https://www.gravatar.com/avatar?d=mp&s=200'}"
                     alt="Avatar"
                     class="avatar">
            </div>
            <div class="user-details">
                <div class="name-row">
                    <h1 th:text="${displayUser.fullName}">Nume utilizator</h1>
                    <div class="more-options dropdown">
                        <button class="more-options-btn"
                                type="button"
                                data-bs-toggle="dropdown"
                                aria-expanded="false"
                                aria-label="Actiuni profil">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="1"></circle><circle cx="12" cy="5" r="1"></circle><circle cx="12" cy="19" r="1"></circle></svg>
                        </button>
                        <ul class="dropdown-menu dropdown-menu-end profile-more-menu">
                            <li th:if="${isOwnProfileView}">
                                <a class="dropdown-item" th:href="@{/profile/edit}">
                                    <i class="bi bi-pencil-square me-2"></i>Editeaza profilul
                                </a>
                            </li>
                            <li th:unless="${isOwnProfileView}">
                                <button class="dropdown-item text-danger"
                                        type="button"
                                        data-bs-toggle="modal"
                                        data-bs-target="#reportProfileModal">
                                    <i class="bi bi-flag me-2"></i>Raporteaza
                                </button>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="location-row">
                    <img src="https://flagcdn.com/w20/ro.png" alt="RO Flag" class="flag">
                    <span th:text="${displayUser.email}">email@example.com</span>
                </div>
                <div class="points-row">
                    <span class="medal-icon">★</span>
                    <span class="points-text"
                          th:text="${reviewCount > 0 ? #numbers.formatDecimal(avgRating, 1, 1) + ' rating' : 'Fara rating'}">
                        Fara rating
                    </span>
                    <svg class="info-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
                </div>
            </div>
        </div>

        <div class="nav-tabs">
            <div class="tab">Profil</div>
            <div class="tab active" th:text="${'Activitati (' + activitiesCount + ')'}">Activitati</div>
            <div class="tab" th:text="${'Feedback (' + reviewCount + ')'}">Feedback</div>
        </div>

        <div class="content-section">
            <h2 class="section-title" th:text="${'Activitatile create (' + activitiesCount + ')'}">Activitatile create</h2>

            <div class="empty-state" th:if="${#lists.isEmpty(createdActivities)}">
                Utilizatorul nu a creat inca activitati.
            </div>

            <div class="favorites-grid" th:if="${!#lists.isEmpty(createdActivities)}">
                <a class="hotel-card-link" th:each="activity : ${createdActivities}" th:href="@{/activities/{id}(id=${activity.id})}">
                    <div class="hotel-card">
                        <div class="card-image"
                             th:style="|background-image: url('${activity.imageUrl}');|">
                            <div class="heart-icon"
                                 th:text="${activity.category != null and !#strings.isEmpty(activity.category) ? #strings.substring(activity.category, 0, 1) : 'A'}">
                                A
                            </div>
                            <div class="discount-badge" th:text="${activity.capacity}">10</div>
                        </div>
                        <div class="card-info">
                            <h3 th:text="${activity.title}">Titlu activitate</h3>
                            <div class="card-meta">
                                <span class="rating">
                                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg>
                                    <span th:text="${#temporals.format(activity.date, 'dd MMM yyyy') + ' · ' + #temporals.format(activity.time, 'HH:mm')}">22 Feb 2026 · 18:00</span>
                                </span>
                                <span class="location">
                                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
                                    <span th:text="${activity.location}">Locatie</span>
                                </span>
                            </div>
                        </div>
                    </div>
                </a>
            </div>
        </div>
    </div>

    <div class="modal fade" id="reportProfileModal" tabindex="-1" aria-labelledby="reportProfileModalLabel" aria-hidden="true" th:if="${!isOwnProfileView}">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="reportProfileModalLabel">Raporteaza utilizator</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Inchide"></button>
                </div>
                <div class="modal-body">
                    Raportarea este pregatita in interfata. Trimiterea efectiva va fi activata in urmatorul pas.
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn custom-btn" data-bs-dismiss="modal">Am inteles</button>
                </div>
            </div>
        </div>
    </div>
</main>

<footer th:replace="~{fragments/footer :: footer}"></footer>

<script src="/js/jquery.min.js"></script>
<script src="/js/bootstrap.bundle.min.js"></script>
<script src="/js/jquery.sticky.js"></script>
<script src="/js/click-scroll.js"></script>
<script src="/js/animated-headline.js"></script>
<script src="/js/modernizr.js"></script>
<script src="/js/custom.js"></script>
</body>
</html>
